### 词法分析设计文档

------

#### 整体流程

->从文件中获取一个合法字符递给词法分析程序

->词法分析状态机程序改变

->词法分析以词为单位向外提供结果

#### 程序内容

###### 文件组织	

| 文件名               | 作用           |
| -------------------- | -------------- |
| main.cpp             | 主函数         |
| lexical_analysis.h   | 词法分析头文件 |
| lexical_analysis.cpp | 词法分析文件   |



###### 主要常量

主要常量即为两个hashmap，保存单词内容向单词类型的映射关系

| 常量                                | 作用             |
| ----------------------------------- | ---------------- |
| static map<string,string> KeyWord   | 关键字的有关映射 |
| static map<string,string> Delimiter | 分隔符的有关映射 |



###### 主要变量

| 变量                       | 作用                             |
| -------------------------- | -------------------------------- |
| static ifstream *inFile    | 指向要打开文件对应的文件流       |
| static char c              | 预读字符                         |
| static string lexical_str  | 词法分析的结果之一，表示词内容。 |
| static string lexical_type | 词法分析的结果之一，表示词类型   |

###### 主要函数

| 函数                                  | 作用                                                         |
| ------------------------------------- | ------------------------------------------------------------ |
| char file_getChar()                   | 每次从文件中获取一个字符                                     |
| void skip_blank()                     | 筛选从文件中不合法字符                                       |
| bool belongTo_Keyword(string word);   | 判断一个字符串是否属于关键字                                 |
| bool belongTo_Delimiter(string word); | 判断一个字符串是否属于分隔符                                 |
| pair<string, string> get_a_word();    | 核心函数<br />根据读入字符进行分支判断并最终返回一个合法的词<br />的内容与类型 |
| void wrong_handle();                  | 错误处理函数                                                 |

###### 核心函数(get_a_word)设计

1.全局变量初始化——将c、 lexical_str、lexical_type进行清空处理。

2.初状态选择——在全局变量为空的状态下，根据读入的第一个字符选择主要分支

| 第一个字符内容       | 分支方向       |
| -------------------- | -------------- |
| '\\''                | 字符常量       |
| '\\"'                | 字符串常量     |
| ['0'~'9']            | 整数           |
| ['_''a'~'z']         | 标识符或关键字 |
| 其它属于分隔符的字符 | 分隔符         |

3.根据接下来字符继续选择分支或者进行正确性判断

4.返回这次分析的词的值与类型

